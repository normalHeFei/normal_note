> 罗列一些常见的概念及理解,后续待补充

- volatile 

1.保证可见性, 不保证原子性, 原子性有CAS 配合自旋实现. **避免重排序**.指令重排只有在 多核及其不存在数据依赖(如两个独立的赋值语句)的情况下cpu 才会进行指令重拍

可见性： 
    产生原因： 线程自己存在自己的工作内存，读取时会将主内存中的变量读到工作内存。多个线程各自读写时就会存在不一致的问题。
原子性：
    不保证的原因：举例说明：比如i++, 是个复合操作，同一时间，不同线程读取的可能是相同的值，这种情况，当a线程已经写完，但b线程之前已经读了，故还是原来的值，产生覆盖
重排序： 
    多核环境下，如果语句之间不存在数据的依赖性的话，编译器|处理器 考虑到性能因素可能会进行指令重拍, volatile 可以借助于内存屏障禁止指令重排 （屏障简单来讲就是起到阻塞的作用，保证顺序，与栅栏一个概念）
    
- CAS

通过cpu 原子指令(cmpxchg) 配合 volatile 可见性实现. 

**CAS 的ABA 问题**

添加时间戳或版本号. 

- 内存屏障 

 内存屏障是CPU或编译器提供的避免指令重排的一系列特殊指令(fence),能保证fence 指令前的load/store(读写指令)在fence 指令后的load/store(读写) 操作之前执行. 

- CPU的缓存模型

1. L1 core 独享, L2 两个 core 共享, L3 是所有core 共享, cpu 的cache 主要缓存指令
https://zhuanlan.zhihu.com/p/48157076